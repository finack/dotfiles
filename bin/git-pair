#!/usr/bin/env ruby
require 'yaml'

PAIRS_FILE = File.expand_path('~/.pairs')

def show_help
  p "Changes your git user.name to specified names from #{PAIRS_FILE}"
  p "Usage: git-pair <initial1> <initial2>"
end

def complain_about_pairs_file
  raise "Please create .pairs file in your home directory in the folowing format\
         sc: Some Chick\
         sd: Some Dude"
end

### main

show_help and exit 0 if ARGV.delete "--help" or ARGV.delete "-h" or ARGV.empty?

complain_about_pairs_file unless File.exist? PAIRS_FILE
pairs = YAML.load_file PAIRS_FILE

names = []
ARGV.each do |opt|
  raise "There is no entry for #{opt} in #{PAIRS_FILE}" unless pairs[opt]
  names << pairs[opt]
end

system "git config user.name '#{names.join ' & '}'"
system "git config user.name"

# vim: ft=ruby
